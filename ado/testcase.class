version 18.0

* Class definition
class testcase {
    string timeformatter = "%tcCCYY-MM-DD_HH:MM:SS"
    string id           // test case identifier
    string name         // test case name
    string filename     // test file name
    double passed       // number of assertions that passed
    double failed       // number of assertions that failed
    string start_dttm   // timestamp of when testing started 
    string end_dttm     // timestamp of when testing stopped 
}

* Constructor
program .new
    syntax, id(string) name(string)
    .id = "`id'"
    .name = "`name'"
    .passed = 0
    .failed = 0
    .start_dttm = strofreal(now(), "`.timeformatter'")
    if c(noisily) {
        display as input "TEST CASE `id': `name'" _newline
    }
end

* Method to increment pass counter
program .pass
    .passed = `.passed' + 1
end

* Method to increment fail counter
program .fail
    .failed = `.failed' + 1
end

* Method to record the time the test finished
program .end
    .end_dttm = strofreal(now(), "`.timeformatter'")
end
